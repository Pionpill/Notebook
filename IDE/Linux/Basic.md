<link rel=stylesheet href=style.css>

# Linux 基础
> 这是学习 `The Linux Command` 的笔记  
> Linux 环境为 Ubuntu 20   

## 1 Linux 基础指令
### 1.1 基础指令与操作
#### 常用指令
- `$ data`：返回当前时间和日期
- `$ cal`：显示当前月份
- `$ df`：查看磁盘可用空间
- `$ free`：查看可用内存容量
- `$ exit`：退出终端
#### GUI 操作
- 复制粘贴
  - 复制：双击终端文件名
  - 粘贴：鼠标中键

### 1.2 导航
#### Linux 文件树 
- Linux 目录结构
  ```json
    ├── /: 根目录
    |   ├── /bin: 可执行的二进制文件目录
    |   ├── /boot: 放置 Linux 系统启动时用到的一些文件
    |   ├── /dev: 存放 Linux 系统下的设备文件
    |   ├── /etc: 系统配置文件放的目录
    |   ├── /home: 系统默认的用户家目录
    |   ├── /lib: 系统使用的函数库的目录
    |   ├── /lost+found: 文件系统损坏时的部分恢复 
    |   ├── /media: 可移动设备，如 USB 端口
    |   ├── /mnt: 手动挂载的各种可移动存储设备 
    |   ├── /opt: 安装"可选" 软件
    |   ├── /proc: 虚拟文件，可通过其中文件了解内核管理计算机
    |   ├── /root: 超级用户主目录
    |   ├── /sbin: 执行重要系统任务
    |   ├── /tmp: 临时文件
    |   ├── /user: 用户用到的所有程序和支持文件
    |   |   ├── /bin: Linux 发行版安装的程序
    |   |   ├── /lib: /user/bin 中程序用到的共享库
    |   |   ├── /local: 超级用户添加的内容
    |   |   ├── /sbin: 更多系统管理工具
    |   |   ├── /share: /user/bin 中程序用到的共享数据
    |   |   |   └── /doc: 系统安装的软件包自带的文档
    |   ├── /var: 动态文件文件夹
    |   |   └── /log: 日志文件
    |   ├── ......
  ```
- 两个常用的 Linux 文件数指令
  - `$ pwd`：获取当前目录
  - `$ ls`：列出当前目录下的文件
    - `$ ls` 指令允许多个路径作为参数

#### 工作目录
- 相对路径与绝对路径
  - `$ cd`：用于更改工作目录
  - 绝对路径：从根目录开始
    - 举例：`$ cd /user/bin`
  - 相对路径：从当前位置开始
    - 举例：`$ cd bin`)
    - 当前工作目录：`.`
    - 上一工作目录：`..`
- Linux 文件的特点
  - 以 . 开头的文件是隐藏的， `$ ls` 指令不会显示 `$ ls -a` 指令会显示
  - Linux 文件名区分大小写
  - Linux 文件命名规范：数字，字母，点号 `.`，半字线 `-`，下划线 `_`
- cd 命名的便捷写法
  | 写法              | 效果                                    |
  | ----------------- | --------------------------------------- |
  | `$ cd`            | 将当前目录更改为用户主目录              |
  | `$ cd -`          | 将当前工作目录切换回前一个工作目录      |
  | `$ cd ~user_name` | 将当前工作目录更改为 user_name 的主目录 |

### 1.3 详细指令参数
#### `$ ls` 指令详解 
- 选项与参数
  - 一般指令格式
    - `$ command -options arguments`
    - 短选项：`-option` 可以同时使用多个，如 `-lt`
    - 长选项：`--option` 
  - 常用 `$ ls` 指令命令选项
    | 短选项 | 长选项           | 描述                                                          |
    | ------ | ---------------- | ------------------------------------------------------------- |
    | -a     | --all            | 列出所有文件，包含隐藏文件                                    |
    | -A     | --almost-all     | 在 -a 基础上，不列出当前工作目录和父目录                      |
    | -d     | --directory      | 与 -l 结合，查看目录详细信息                                  |
    | -F     | --classify       | 在每个列出的名称后面加上类型指示符                            |
    | -h     | --human-readable | 在 -l 长格式输出结果中，不以 B 为单位，改用人类可读的文件大小 |
    | -l     |                  | 以长格式显示输出结果                                          |
    | -r     | --reverse        | 降序显示                                                      |
    | -S     |                  | 按文件大小排序输出结果                                        |
    | -t     |                  | 按修改日期排序输出结果                                        |
- 长格式
  - 示例 `$ ls -lh` 
  - 输出：`drwxr-xr-x 3 pionpill pionpill 40K 4] 7 17: 32 Desktop -> Desktop_Pionpill`
    | 字段             | 子字段 | 含义                                       |
    | ---------------- | ------ | ------------------------------------------ |
    | drwxr-xr-x       | d      | 第一个 d 表示为文件夹，若为 - 表示普通文件 |
    |                  | rwx    | 文件属主的访问权限                         |
    |                  | r-x    | 文件属组的访问权限                         |
    |                  | r-x    | 其他人的访问权限                           |
    | 3                |        | 文件硬链接数量                             |
    | pionpill         |        | 文件属主                                   |
    | pionpill         |        | 文件属组                                   |
    | 4.0K             |        | 文件大小                                   |
    | 4月 7 17:32      |        | 文件最后修改日期                           |
    | Desktop          |        | 文件名                                     |
    | Desktop_Pionpill |        | 文件真实名                                 |

#### `$ file` 指令
- Unix/Linux 系统认为任务皆文件
- `$ file` 将显示文件的基础信息

#### `$ less` 指令
- `$ less <filename>` 查看文本文件内容
- 文本文件操作
  |           命令/按键 | 效果   |   命令/按键 | 效果           |
  | ------------------: | ------ | ----------: | -------------- |
  |         Page Up / b | 后翻   |           g | 文件头         |
  | Page Down / 'space' | 前翻   | /characters | 搜索指定字符串 |
  |                 '↑' | 后一行 |           n | 重复上一次搜索 |
  |                 '↓' | 前一行 |           h | 帮助           |
  |                   G | 文件尾 |           q | 退出           |



## 2 文件操作与命令
### 2.1 操作文件和目录
#### 通配符

- 通配符及其含义
  | 通配符        | 含义                                           |
  | ------------- | ---------------------------------------------- |
  | *             | 匹配任意多个字符                               |
  | ?             | 匹配任意单个字符                               |
  | [characters]  | 匹配属于字符集合 characters 中的任意单个字符   |
  | [!characters] | 匹配不属于字符集合 characters 中的任意单个字符 |
  | [[:class:]]   | 匹配属于字符类 class 中的任意单个字符          |
- 常用的字符类
  | 字符类    | 含义                     |
  | --------- | ------------------------ |
  | [:alnum:] | 匹配任意单个字母数字字符 |
  | [:alpha:] | 匹配任意单个字母         |
  | [:digit:] | 匹配任意单个数字         |
  | [:lower:] | 匹配任意单个小写字母     |
  | [:upper:] | 匹配任意单个大写字母     |
#### 文件操作指令
- `$ mkdir` 创建目录
  - 用法：`$ mkdir directory...`
- `$ cp` 复制文件和目录
  - 将单个文件或目录复制到单个文件或目录：`$ cp item1 item2`
  - 将多个文件或目录复制到目录 directory：`$ cp item... directory`
  - 可选项
    | 短选项 | 长选项        | 含义                                 |
    | ------ | ------------- | ------------------------------------ |
    | -a     | --archive     | 复制文件和目录及其权限在内的所有属性 |
    | -i     | --interactive | 在覆盖已有文件之前，提示用户确认     |
    | -r     | --recursive   | 递归复制目录及内容                   |
    | -u     | --update      | 仅复制不存在或更新的文件             |
    | -v     | --verbose     | 在进行复制时显示相关信息             |
- `$ mv` 移动和重命名文件
  - 将单个文件或目录移动/重命名到单个文件或目录：`$ mv item1 item2`
  - 将多个文件或目录移动/重命名到目录 directory：`$ mv item... directory`
  - 可选项
    | 短选项 | 长选项        | 含义                             |
    | ------ | ------------- | -------------------------------- |
    | -i     | --interactive | 在覆盖已有文件之前，提示用户确认 |
    | -u     | --update      | 仅移动不存在或更新的文件         |
    | -v     | --verbose     | 在进行复制时显示相关信息         |
- `$ rm` 删除文件和目录
  - 用法：`$ rm item...`
  - 可选项
    | 短选项 | 长选项        | 含义                                        |
    | ------ | ------------- | ------------------------------------------- |
    | -i     | --interactive | 在删除已有文件之前，提示用户确认            |
    | -r     | --recursive   | 递归复制目录及内容                          |
    | -f     | --force       | 忽略不存在的文件，不提示。此可选项将屏蔽 -i |
    | -v     | --verbose     | 在进行删除时显示相关信息                    |
#### 硬链接与符号链接
- 硬链接
  - 默认一个文件只有一个硬链接，由其为文件赋予名称
  - 可以创建格外的硬链接，也就相当于创建了一个目录项
  - 硬链接的限制
    - 硬链接不能引用所在文件系统之外的文件，即不能引用不同磁盘的文件
    - 硬链接不能引用目录
  - 删除一个文件的一个硬链接不能删除文件，需要删除该文件的所有硬链接才行
  - 创建硬链接 `$ ln file link`
  - 相同硬链接指向同一区域
  - 可以通过 `$ ls -i` 查看第一个字段，即节点号，判定是否为同一文件的硬链接
- 符号链接
  - 符号链接旨在弥补硬链接的两个限制
  - 符号链接类似于 Windows 的快捷方式
  - 向符号链接写入的内容等同于想写入被引用的文件
  - 如果符号链接引用的文件被删除，符号链接将变成无效链接，`$ ls` 指令会用颜色告知用户(一般为红色)
  - 创建符号链接 `$ ln -s item link`

### 2.2 命令
#### 命令的定义
- 符合以下条件之一都可以成为命令
  - 可执行程序，在 `/user/bin` 中的文件，可以是可执行文件也可以是脚本
  - Shell 内建命令
  - Shell 函数
  - 别名。在其他命令基础上自定义的命令
#### 识别命令
- `$ type` 显示命令类型
  - Shell 内建命令，显示命令属于哪一类
  - 用法 `$ type <command>`
- `$ which` 显示可执行文件位置
  - 用法 `$ which <command>` 
  - 只能显示可执行文件位置，对于内建，别名无效
#### 命令帮助
- `$ help` 获取帮助信息
  - 用法 `$ help <command>`
- `$ --help` 显示用法信息
  - 用法 `$ <command> --help`
  - 显示命令所支持的语法和选项的相关描述
- `$ man` 显示命令的手册页
  - 用法 `$ man [section] <program>`
  - 大多数用于命令行的程序都会提供一份手册页
  - 手册页往往分为几节，可以通过 [section] 指定打开的节
- `$ apropos` 显示适合的命令清单
  - 用法 `$ apropos <keyword>`
  - 根据关键字在手册页列表中搜索可能的匹配项
- `$ whatis` 显示手册页的简述
  - 用法 `$ whatis <command>`
  - 显示匹配指定关键字的手册页名称和当行描述
- `$ info` 显示程序的 info 条目
  - 用法 `$ info <command>`
  - info 指令用于替代手册页，提供阅读器显示
  - info 阅读器的操作
    |  命令 | 操作               |             命令 | 操作     |
    | ----: | ------------------ | ---------------: | -------- |
    |     ? | 显示帮助信息       | PGUP / BackSpace | 上一页   |
    |     u | 显示父节点         |   PGON / 'space' | 下一页   |
    | Enter | 进入光标所在超链接 |                n | 下一节点 |
    |     q | 退出               |                p | 上一节点 |
#### 使用 alias 自定义命令
- 多个指令执行
  - `command1; command2; command3...`
- 子定义别名的步骤
  1. 使用 `$ type <command>` 指令查询指令名是否已存在
  2. 使用 `$ alias name ='string'` 创建别名
  3. 使用 `$ unalias <command>` 删除别名
- 备注
  - 使用不带参数的 `$ alias` 指令可以查询系统定义的所有别名
  - 当别名未被保存时，若 Shell 会话结束，别名也将随之消失

### 2.3 重定向
#### 标准输出重定向
- 重定向操作符 `>`
  - 用法 `$ <command> > <file>`
  - 例：`$ ls -l /user/bin > ls-out.txt`
  - 标准输出重定向即将标准输出存放到指定文件
  - 如果出现错误，则不会输出，并提示错误，这是因为标准错误不是标准输出
  - 如果使用 `$ > <file>` 指令，将截断或者创建一个新文件
- 追加文件操作符 `>>`
  - 使用 `>>` 替换 `>` 将在文件尾部添加内容
#### 标准错误重定向
- 基本概念
  - 标准错误重定向没有专门的符号
  - Shell 内部文件流表示
    - 标准输入：0
    - 标准输出：1
    - 表尊错误：2
  - 重定向表尊错误
    - 用法 `$ <command> 2> <file>`
- 将标准输出和标准错误重定向到同一个文件
  - 重定向操作的顺序
    - 标准错误重定向操作必须在标准输出重定向之后
  - 旧版 Shell 实现
    - 例 `$ ls -l /bin/user > ls-out.txt 2>&1`
    - 先标准输出重定向，再用 `2>&1` 将文件描述符2(标准错误)重定向到文件描述符1(标准输出)
  - 新版本 Shell 实现
    - 例 `$ ls -l /bin/user &> ls-out.txt `
    - 例 `$ ls -l /bin/user &>> ls-out.txt `
- 丢弃用不着的输出结果
  - 垃圾桶 `/dev/null` 接受输入结果但不做任何处理
  - 例 `$ ls -l /bin/user 2> /dev/null`

#### 标准输入重定向
- `$ cat` 指令
  - 用法 `$ cat <filename>`
  - 读取一个或多个文件并将其复制到标准输出
  - 大多数情况下，`cat` 指令和 `type` 指令等同
    - `cat` 通常用于显示比较短的文本文件。
    - `cat` 指令可以接收多个文件作为参数，所以还可用于将文件拼接在一起
    - 可以使用类使 `cat text1.txt text2.txt ... > text.txt` 将多个文件合并输出
  - 无参数 `cat` 指令
    - 将等待用户从标准输入(键盘)中读取
    - 结束键：Ctrl + D
  - 标准定向操作符 `<`
    - 通过 `<` 操作符可以将文件作为标准输入
    - 与直接读取文件相比，并没有什么差别

#### 管道
- 管道操作符 `|`
  - 用法 `command1 | command2`
  - 说明：将 command1 的标准输出传给 command2 的标准输入
  - 例如：`$ ls -l /user/bin | less`: 将文件详细信息以分页方式显示
- `sort` 排序列表 
  - `$ ls /bin /user/bin | sort | less`
  - 将多个文件目录排序并按页输出
- `uniq` 报告或忽略重复行
  - 忽略重复行：`$ ls /bin /user/bin | sort | uniq | less`
  - 报告重复行：`$ ls /bin /user/bin | sort | uniq -d | less`
- `wc` 统计换行符，单词，字节
  - 用法 `wc <filename>`
  - 显示行数，单词树，字数 `$ wc text.txt`
  - 显示行数 `$ ls /bin /user/bin | sort | uniq | wc -l`
- `grep` 输出与模式匹配的行
  - 用法 `$ grep pattern filename`
  - `grep` 指令能通过正则表达式匹配: `$ ls /bin /user/bin | sort | uniq | grep zip`
  - 两个有用的可选参数
    - `-i` 忽略大小写
    - `-v` 只输出不匹配的内容
- `head/tail` 输出开头/结尾部分
  - 用法 `$ head/tail [-n] <filename>`
  - 可以通过 `-n 5` 指定只显示 5 行
  - 例 `$ ls /user/bin | tail -n 5`
- `tee` 读取标准输入并写入标准输出文件
  - `tee` 指令类使 T 管道，将标准输入写入当前标准输出文件中，但又不影响管道中的下一指令
  - 例 `$ ls /user/bin | tee ls.txt | grep zip`

### 2.4 指令扩展
#### 扩展的概念
- Shell 在执行指令前回对一些文本进行替换操作，这一过程被称为扩展
- `$ echo` 指令：将文本参数输出到标准输出
#### 路径名扩展
- 通配符的工作机制称为路径名扩展
- `$ echo *` 将显示路径下文件名
#### 波浪线扩展
- 用于单词之前，扩展为同名用户的主目录
#### 算术扩展
- 用法 `$((expression))`
- 仅仅支持整数运算
- 允许嵌套，支持加，减，乘，除，取模，幂运算
#### 花括号扩展
- `,` ：各匹配一次
  - `$ echo Number_{1,2,3}`: Number_1,Number_2,Number_3
- `..`：范围匹配
  - `$ echo {01..03}`: 01,02,03
- 组合举例
  - `$ echo a{A{1,2},B{3,4}}b`：aA1b,aA2b,aB3b,aB4b
- 参数扩展
  - 参数扩展允许我们将数据保存在变量中
  - `$ echo $USER`
- 命令扩展
  - 命令扩展允许我们使用命令的输出结果作为扩展结果
  - 例 `$ echo $(ls)`

### 2.5 引用
#### 双引号
- 双引号中的文本将失去特殊字符含义
- 一下字符仍具有特殊含义：$ \ `
#### 单引号
- 禁止所有扩展，所有内容将失去特殊含义
#### 转义字符
- 在双引号中，可以通过 `\` 将某个特殊字符转换为无意义
- 特殊转义字符
  | 转义序列 | 含义   | 转义序列 | 含义   |
  | -------- | ------ | -------- | ------ |
  | \a       | 响铃   | \b       | 退格符 |
  | \n       | 新行   | \r       | 回车符 |
  | \t       | 制表符 |          |        |

### 2.6 键盘技巧
#### 组合键键
- 光标移动组合键
  | 组合键       | 操作                   | 组合键       | 操作                 |
  | ------------ | ---------------------- | ------------ | -------------------- |
  | Ctrl - A     | 光标移动到行首         | Ctrl - E     | 光标移动到行尾       |
  | Ctrl - F / → | 光标向后移动一个字符   | Ctrl - B / ⬅ | 光标向前移动一个字符 |
  | Alt - F      | 光标向后移动一个单词   | Alt - B      | 光标向前移动一个单词 |
  | Ctrl - L     | 清除屏幕，等同于 clear |
- 修改命令行文本的组合键
  | 组合键   | 操作                           | 组合键   | 操作                           |
  | -------- | ------------------------------ | -------- | ------------------------------ |
  | Ctrl - D | 删除光标处字符                 | Ctrl - T | 将光处字符与之前字符对调       |
  | Alt - T  | 将光处单词与之前单词对调       | Alt - L  | 将光标处到单词结尾处字符转小写 |
  | Alt - U  | 将光标处到单词结尾处字符转大写 |          |                                |
- 剪切粘贴组合键
  | 组合键   | 操作                                  | 组合键          | 操作                             |
  | -------- | ------------------------------------- | --------------- | -------------------------------- |
  | Ctrl - K | 剪切从光标处到行尾的文本              | Ctrl - U        | 剪切从光标处到行首的文本         |
  | Alt - D  | 剪切从光标处到当前单词结尾的文本      | Alt - BackSpace | 剪切从光标处到当前单词开头的文本 |
  | Ctrl - Y | 将 kill-ring 缓冲区的文本粘贴到光标处 |
#### 补全机制
- Shell 可以通过 Tab 键实现自动补全功能
- 若没有歧义，补全功能将实现，若有，则需要更精确的名称
- 补全功能相关的组合键
  | 组合键  | 操作                                            |
  | ------- | ----------------------------------------------- |
  | Alt - $ | 显示可能的补全结果，多数系统支持按两次 Tab 实现 |
  | Alt - * | 插入所有可能的补全结果                          |
#### 命令历史记录
- 搜索历史记录
  - `$ history | less` 查看历史记录的内容
  - `$ history | grep /user/bin` 找出特定目录下的历史记录
    - 若显示 `88 history ...` 中 88 表示有 88 条指令
    - 可以使用 `!num` 扩展为历史记录中第 num 行 内容
  - 增量搜索
    - 按 `Ctrl - R` 输入内容，开始匹配搜索
    - `Enter / Ctrl - J` 将匹配项从历史记录复制到当前行
    - `Ctrl - R` 查找下一个匹配项
    - `Ctrl - G / Ctrl - C` 退出搜索 
  - 历史操作组合键
    | 组合键       | 操作                         | 组合键   | 操作                                 |
    | ------------ | ---------------------------- | -------- | ------------------------------------ |
    | Ctrl - P / ↑ | 上一条历史记录               | Ctrl - R | 反向增量搜索                         |
    | Ctrl - N / ↓ | 下一条历史记录               | Alt - P  | 非增量反向搜索                       |
    | Alt - <      | 移动到历史记录列表开头(顶部) | Alt - N  | 非增量向前查找                       |
    | Alt - >      | 移动到历史记录列表结尾(底部) | Ctrl - O | 执行历史记录中命令并移动到下一条命令 |
#### 历史扩展
- 历史扩展命令
  | 序列    | 操作                           | 序列     | 操作                                 |
  | ------- | ------------------------------ | -------- | ------------------------------------ |
  | !!      | 重复上一个命令                 | !number  | 重复历史记录列表中的第 number 个命令 |
  | !string | 重复 string 开头的最后一个命令 | !?string | 重复包含 string 的最后一个命令       |

## 3 权限
### 3.1 文件权限
#### 属主，属组以及其他用户
- 属主(uid)：用户, 定义在 `/etc/passwd` 文件中，在 `etc/shadow` 中保存了用户的密码信息
- 属组(gid)：一个或多个用户组成的组, 定义在 `/etc/group` 文件中
- 属组用户被文件和目录的属主授予访问权
- 使用 `$ id` 指令可以查看用户信息
#### 读取，写入和执行
- 文件类型：对于使用 `$ls -l` 指令现实的的文件属性，第一个字符表示文件类型，
- 如 `-rwxrwxrwx 1 root root 69 12] 30 2020 hello world. c`
- 首字符对应文件类型
  | 属性 | 文件类型                             |
  | ---- | ------------------------------------ |
  | -    | 普通文件                             |
  | d    | 目录                                 |
  | l    | 符号链接                             |
  | c    | 字符设备文件，按字符流处理数据的设备 |
  | b    | 块设别文件，如 DVD 设备              |
- 文件剩下的 9 个字符是文件模式，分别代表文件属主，属组，其他用户的读取，写入，执行权限
- 设置权限属性后的效果
  | 属性 | 文件                                             | 目录                               |
  | ---- | ------------------------------------------------ | ---------------------------------- |
  | r    | 允许打开并读取                                   | 允许列出 目录 内容                 |
  | w    | 允许写入或阶段。不允许重命名或删除               | 允许在目录内创建，删除，重命名文件 |
  | x    | 允许将该文件作为程序执行，脚本语言程序必须为可读 | 允许进入目录                       |
#### 修改文件模式 - chmod
- `$ chmod` 指令
  - 用法 `$ chmod <right> <filename>`
- 八进制表示法
  - 八进制表示与权限映射表
    | 八进制形式 | 二进制形式 | 文件模式 |
    | ---------- | ---------- | -------- |
    | 0          | 000        | ---      |
    | 1          | 001        | --x      |
    | 2          | 010        | -w-      |
    | 3          | 011        | -wx      |
    | 4          | 100        | r--      |
    | 5          | 101        | r-x      |
    | 6          | 110        | rw-      |
    | 7          | 111        | rwx      |
  - 举例：`$ chomod 600 ls-out.txt`
    - 结果：`-rw------- 1 pionpill pionpill 6 8月 19 17:07 ls-out txt`
- 符号表示法
  - 符号表示法的组成：改动对象，执行操作，设置权限
  - 改动对象
    | 符号 | 含义       | 符号 | 含义                    |
    | ---- | ---------- | ---- | ----------------------- |
    | u    | user 属主  | o    | other 其他用户          |
    | g    | group 属组 | a    | all 相当于 u，g，o 全体 |
  - 操作符
    - +：添加权限
    - -：去除权限
    - =：赋予指定权限，同时去除其他所有权限
  - 举例：`$ chmod u+x,go=rx ls-out.txt`
    - 结果：`rwxr-xr-x 1 pionpill pionpill 6 8月 19 17: 07 ls-out txt`
  - Linux 同样支持右键在 Permission 中设置权限

#### 设置默认权限 - umask
  - 用法 `$ umask [value]`
  - 不带参数的 `umask` 可以获取当前的掩码值，带参数则表示设置系统默认掩码值
  - 一般不需要重设掩码值
  - 掩码值对应八进制表示法，其计算方式如下：
    - 默认文件掩码值：666 目录掩码值 777
    - 若掩码值为 xxx
    - 则系统创建默认文件权限为 (6-x)(6-x)(6-x)，目录类推

#### 特殊权限
- 特殊权限
  - 常见八进制权限用 3 位数字表示，但技术上使用 4 位数，另一位表示特殊权限
- `setuid` 位权限 (4000)
  - 如果应用于可执行文件，会将有效用户 ID 从真实用户 ID 更改为程序属主的有效用户 ID
  - 只有极少数情形才使用该权限，会带来安全隐患
- `setgid` 位权限 (2000)
  - 如果应用于可执行文件，会将有效组 ID 从真实组 ID 更改为程序属主的有效组 ID
  - 如果对目录设置此权限，在该目录下新创建的文件将由该目录的属组所有，而非文件创建者属组所有
  - 这个权限相对比较常用
- `sticky` 位权限 (1000)
  - 用于将可执行文件标记为 `不可交换`

### 3.2 改变用户身份
#### `su` 以其他用户身份启动 Shell
- 用法 `su [-[l]] [user]`
  - `-l`: 作为指定用户登录，并加载相关环境，目录更改到该用户主目录
  - `user`：如果无用户，如 `$ su -`，则启用超级用户，如果进入超级用户，`$` 将变成 `#`
  - 通过 `exit` 指令可以退出用户\
- 利用 `su` 执行单个指令
  - 用法 `$ su -c 'command'`
  - 采用这种形式，命令将被传入新的 Shell 执行，命令一定要放在引号中
#### `sudo` 以其他用户身份执行命令
- 超级用户可以配置 `sudo` 指令，允许普通用户在可控的方式下以其他用户的身份执行命令(通常是超级用户)
- 在特定情况下，用户被限定只能执行一条或几条特定的命令
- `sudo` 指令无需输入超级用户密码，只需要输入用户自己的密码
- `sudo` 指令无需加载环境，使用 `-i` 选项可用于启动一个交互式的超级用户 Shell 会话
#### `chown` 更改文件属主和属组
- `chown` 指令需要超级用户权限
- 用法 `$ chown [owner][:[group]] file...`
- 参数示例
  | 参数      | 结果                                                               |
  | --------- | ------------------------------------------------------------------ |
  | bob       | 将文件所有权由当前属主改为用户 bob                                 |
  | bob:users | 将文件所有权由当前属主改为用户 bob,将文件属组改为 users 组         |
  | :admins   | 将文件属组改为 admins                                              |
  | bob:      | 将文件所有权由当前属主改为用户 bob,将文件属组改为用户 bob 的登录组 |

#### `passwd` - 修改密码
- 用法 `password [user]`
- Linux 会要求你使用强密码，即太容易被猜到，太短...密码会被拒绝

## 4 进程
### 4.1 查看进程
#### `ps` 指令
- `ps` 指令用于此案时当前系统的进程
  - 各字段含义
    | 字段 | 含义                  | 字段 | 含义       |
    | ---- | --------------------- | ---- | ---------- |
    | PID  | 进程 ID               | TTY  | 电传打字机 |
    | TIME | 进程消耗 CPU 时间总和 | CMD  | 命令       |
- `$ ps x` 指令
  - 使 `ps` 指令显示所有的进程，不管进程是由哪个终端控制的，TTY 中的 ? 表示没有控制终端
  - state 字段含义
    | 状态 | 含义                            | 状态 | 含义                       |
    | ---- | ------------------------------- | ---- | -------------------------- |
    | R    | 运行，表正在运行或准备运行      | S    | 睡眠，进程正在等待某个事件 |
    | D    | 不可中断的睡眠，一般正在等待 IO | T    | 已停止                     |
    | Z    | 已死，但未被父进程清理          | <    | 高级优先进程               |
    | N    | 低级优先进程                    |      |                            |
- `$ ps aux` 指令
  - 将显示更多的信息
    | 字段 | 含义       | 字段  | 含义         |
    | ---- | ---------- | ----- | ------------ |
    | USER | 用户 ID    | %CPU  | CPU 占用率   |
    | %MEM | 内部占用率 | VSZ   | 虚拟内存大小 |
    | RSS  | 驻留集大小 | START | 进程启动时间 |
#### `top` 命令动态查看进程
- `top` 指令会依据进程活动顺序显示持续更新 (默认 3s 更新一次)
- [详细参数](https://zhuanlan.zhihu.com/p/36995443)
#### 其他常用进程指令
- 常用进程指令
  | 命令   | 描述                                                       |
  | ------ | ---------------------------------------------------------- |
  | pstree | 从树状结构输出进程列表，呈现进程之间的父子关系             |
  | vmstat | 输出进程的详细信息，可以同加一个事件数字(如5) 动态持续显示 |
  | xload  | 图形化程序，随事件绘制显示系统负载的程序                   |
  | tload  | 与 xload 类似，不过是在终端中绘制                          |
### 4.2 进程控制
#### 中断进程
- Linux 绝大多数程序都可以通过 `Ctrl - C` 组合键中断
#### 进程置于后台
- 可以通过在指令后面添加一个 `&` 的形式将进程置于后台，例如 `$ xlogo &`
- 这将返回一个 PID，同时可以通过 `jobs` 指令查看作业列表

#### 使进程返回前台
- 前台的键盘输入对后台的进程无效
- 可以使用 `fg [%[num]]` 指令将进程返回前台
  - 其中 `[num]` 代表作业号，可以通过 `job` 指令查看
#### 停止进程
- 可以使用 `Ctrl - Z` 组合键停止进程
- 对于停止的进程，要么使用 `fg` 指令让其在前台运行，要么使用 `bg` 指令让其在后台运行

### 4.3 `kill` - 信号
#### `kill` 向进程发送信号
- 用法：`$ kill [-signal] <PID>...`
  - -`signal` 选项：默认为 TERM
    | 编号 | 名称 | 英文          | 接收方 | 含义                                           |
    | ---- | ---- | ------------- | ------ | ---------------------------------------------- |
    | 1    | HUP  | hang up       | 进程   | 挂起                                           |
    | 2    | INT  | interrupt     | 进程   | 中断，即中止程序                               |
    | 9    | KILL | kill          | 内核   | 立即终止进程，不给予妥善保存的事件             |
    | 15   | TERM | terminate     | 进程   | 终止，如果进程还有足够活力接收信号，则进程终止 |
    | 18   | CONT | continue      | 进程   | 在 STOP/TSTP 后恢复，bg 于 fg 指令也会发送这个 |
    | 19   | STOP | stop          | 内核   | 并不终止，只是暂停                             |
    | 20   | TSTP | terminal stop | 进程   | Ctrl - Z 指令会发送                            |
  - 系统常用信号
    | 编号 | 名称  | 英文                   | 含义                     |
    | ---- | ----- | ---------------------- | ------------------------ |
    | 3    | QUIT  | quit                   | 退出                     |
    | 11   | SEGV  | segmentation violation | 段错误，进程违规使用内存 |
    | 28   | WINCH | windows change         | 窗口大小发生变化         |
- `killall` 向多个进程发送信号
  - 用法 `$ killall [-u user] [-signal] <name>...`

### 4.4 关闭系统
#### 三个常见关机指令
- 三种关机方式：挂起(睡眠)，关机，重启
- 对应 `halt` `poweroff` `reboot` 指令，一般配合 `sudo` 超级用户权限使用
- 举例：`$ sudo reboot`
#### `shutdown` 关机
- `shutdown` 指令可以指定操作类型，可以提供延时挂机，向全体用户广播
- 举例：`$ sudo shutdown -r now`
